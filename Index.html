<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>iSEC Dimension3.0 Games - Snakes & Ladders (Browser)</title>
  <style>
    :root{--size:600px;--cell:calc(var(--size)/10)}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;display:flex;gap:20px;padding:20px;background:#f2f6f9}
    .board-wrap{width:var(--size);position:relative;border-radius:8px;overflow:visible}
    .board{width:var(--size);height:var(--size);display:grid;grid-template-columns:repeat(10,1fr);grid-auto-rows:1fr;border-radius:8px;box-shadow:0 6px 18px rgba(22,40,60,0.12);overflow:hidden}
    .cell{box-sizing:border-box;border:1px solid rgba(0,0,0,0.06);display:flex;align-items:flex-end;justify-content:flex-end;padding:6px;position:relative;background:linear-gradient(180deg,#fff,#fbfdff)}
    .cell .num{position:absolute;top:6px;left:6px;font-size:12px;color:#333;font-weight:600}
    .cell .tokens{display:flex;gap:6px;z-index:6;position:relative}
    .token{width:26px;height:26px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:700;box-shadow:0 2px 6px rgba(0,0,0,0.25)}
    .controls{max-width:420px;flex:1}
    .players{display:flex;flex-direction:column;gap:8px;margin-bottom:12px}
    label{display:flex;gap:8px;align-items:center}
    input[type="text"]{padding:8px;border:1px solid #ddd;border-radius:8px}
    button{padding:8px 12px;border-radius:8px;border:0;background:#1769aa;color:#fff;cursor:pointer;transition:background 0.18s}
    button:hover{background:#145b86}
    button.secondary{background:#666}
    .log{height:220px;overflow:auto;border:1px solid #eee;padding:8px;border-radius:6px;background:#fff}
    .settings{margin-top:8px}
    .modal{position:fixed;inset:0;background:rgba(0,0,0,0.48);display:none;align-items:center;justify-content:center;z-index:120}
    .modal .card{background:#fff;padding:18px;border-radius:10px;max-width:720px;width:92%;box-shadow:0 10px 30px rgba(2,6,23,0.18)}
    .question{margin:12px 0}
    .choices{display:flex;flex-direction:column;gap:8px}
    .small{font-size:13px;color:#444}
    .footer-hint{margin-top:8px;color:#666;font-size:13px}
    textarea{width:100%;height:110px;border-radius:8px;padding:8px;border:1px solid #ddd}
    /* overlay styling */
    svg#overlay{position:absolute;top:0;left:0;z-index:2;pointer-events:none}
    .ladder-line{stroke:#5d4037;stroke-width:8;stroke-linecap:round}
    .ladder-rung{stroke:#a1887f;stroke-width:5;stroke-linecap:round}
    .snake-path{stroke:#c62828;stroke-width:8;stroke-linecap:round;fill:none;stroke-linejoin:round}
    .snake-head{fill:#b71c1c;stroke:#4a0404;stroke-width:2}
    .marker-label{font-size:12px;fill:#fff;font-weight:700;text-anchor:middle}
    .uploader{display:flex;gap:8px;align-items:center;margin-top:8px}
    .uploader input{cursor:pointer}
    @media(max-width:900px){body{flex-direction:column;align-items:center}} 
  </style>
</head>
<body>
  <div class="board-wrap">
    <div id="board" class="board" aria-hidden="false"></div>
    <svg id="overlay" width="600" height="600" viewBox="0 0 600 600" preserveAspectRatio="none"></svg>
  </div>

  <div class="controls">
    <h2>Snakes & Ladders â€” Quiz Edition</h2>
    <div class="players" id="playerInputs"></div>
    <div style="display:flex;gap:8px;margin-bottom:8px">
      <button id="addPlayer">Add Player</button>
      <button id="startBtn">Start Game</button>
      <button id="resetBtn" class="secondary">Reset</button>
    </div>

    <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px">
      <button id="rollBtn" disabled>Roll Dice</button>
      <div id="dice" class="small">Dice: -</div>
      <div id="currentTurn" class="small" style="margin-left:auto">Turn: -</div>
    </div>

    <div class="settings">
      <h4>Game Settings</h4>
      <label><input type="checkbox" id="ladderNeedsQuestion" checked> Require question to climb ladder</label>
      <label><input type="checkbox" id="snakeNeedsQuestion" checked> Allow question to avoid snake</label>
    </div>

    <div class="uploader">
      <div>
        <label>Snake image: <input id="snakeImageInput" type="file" accept="image/*"></label>
      </div>
      <div>
        <label>Ladder image: <input id="ladderImageInput" type="file" accept="image/*"></label>
      </div>
      <div>
        <button id="clearIcons" class="secondary">Clear Icons</button>
      </div>
    </div>

    <div style="margin-top:12px">
      <h4>Question Bank (editable)</h4>
      <small class="small">Edit JSON array of questions below. Each question: {"q":"...","choices":["a","b"],"answer":0}</small>
      <textarea id="questionData"></textarea>
      <div style="display:flex;gap:8px;margin-top:8px">
        <input type="file" id="fileInput" accept="application/json" style="display:none"/>
        <button id="saveQuestions">Save Questions</button>
        <button id="loadSample" class="secondary">Load Questions from File</button>
      </div>
    </div>

    <div style="margin-top:12px">
      <h4>Game Log</h4>
      <div class="log" id="log"></div>
    </div>

    <p class="footer-hint">Open this file in your browser. To share, upload to any static host (GitHub Pages). For networked multiplayer, ask and I'll add a simple server version.</p>
  </div>

  <!-- Question Modal -->
  <div id="modal" class="modal" role="dialog" aria-modal="true">
    <div class="card">
      <h3 id="modalTitle">Question</h3>
      <div id="modalBody">
        <div class="question" id="qText"></div>
        <div class="choices" id="qChoices"></div>
        <div style="display:flex;gap:8px;margin-top:12px">
          <button id="submitAnswer">Submit</button>
          <button id="cancelAnswer" class="secondary">Cancel (treat as wrong)</button>
        </div>
      </div>
    </div>
  </div>

<script>
// ---------------- CONFIG ----------------
const CSS_BOARD_SIZE = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--size')) || 600;
const CELL_SIZE = CSS_BOARD_SIZE / 10;
const BOARD_PX = CSS_BOARD_SIZE;

// snakes and ladders mapping (start->end)
let snakes = {16:6,48:30,64:60,79:19,93:68,95:24,97:76};
let ladders = {2:38,7:14,8:31,15:26,21:42,28:84,36:44,51:67,71:91,78:98};

let questionBank = [
  {q: "What is the capital of France?", choices:["Paris","Berlin","Rome","Madrid"], answer:0},
  {q: "2+2=?", choices:["3","4","5","22"], answer:1},
  {q: "Which language runs in a browser?", choices:["Python","C++","JavaScript","Java"], answer:2},
  {q: "HTML stands for?", choices:["HyperText Markup Language","Home Tool Markup Language","Hyperlink Text Marking","None"], answer:0}
];

// STATE
let players = []; // {name, pos, color}
let currentPlayer = 0;let started=false;let pendingSpecial=null;
const COLORS = ['#1abc9c','#3498db','#e67e22','#9b59b6','#e74c3c','#34495e','#f1c40f'];

// images (data URLs)
let snakeImgData = null; let ladderImgData = null;

// UI refs
const boardEl = document.getElementById('board');
const overlay = document.getElementById('overlay');
const playerInputs = document.getElementById('playerInputs');
const addPlayerBtn = document.getElementById('addPlayer');
const startBtn = document.getElementById('startBtn');
const resetBtn = document.getElementById('resetBtn');
const rollBtn = document.getElementById('rollBtn');
const diceEl = document.getElementById('dice');
const currentTurnEl = document.getElementById('currentTurn');
const logEl = document.getElementById('log');
const modal = document.getElementById('modal');
const qText = document.getElementById('qText');
const qChoices = document.getElementById('qChoices');
const submitAnswer = document.getElementById('submitAnswer');
const cancelAnswer = document.getElementById('cancelAnswer');
const questionData = document.getElementById('questionData');
const saveQuestions = document.getElementById('saveQuestions');
const loadSample = document.getElementById('loadSample');
const ladderNeedsQuestion = document.getElementById('ladderNeedsQuestion');
const snakeNeedsQuestion = document.getElementById('snakeNeedsQuestion');
const snakeImageInput = document.getElementById('snakeImageInput');
const ladderImageInput = document.getElementById('ladderImageInput');
const clearIcons = document.getElementById('clearIcons');

// ---------------- HELPERS ----------------
function log(msg){const p=document.createElement('div');p.textContent=msg;logEl.prepend(p);} 
function clamp(v,a,b){return Math.max(a,Math.min(b,v));}

// Map a cell number (1..100) to center coordinates (x,y) in SVG/px (origin top-left)
function cellCenter(num){
  const n = clamp(parseInt(num),1,100);
  const rowFromBottom = Math.floor((n-1)/10); // 0..9
  const rowFromTop = 9 - rowFromBottom; // 9..0
  const withinRow = (n-1) % 10; // 0..9
  let col;
  if(rowFromBottom % 2 === 0){ // left->right on that row
    col = withinRow;
  } else { // right->left on that row
    col = 9 - withinRow;
  }
  const x = col * CELL_SIZE + CELL_SIZE/2;
  const y = rowFromTop * CELL_SIZE + CELL_SIZE/2;
  return [x,y];
}

function drawOverlay(){
  // ensure the overlay matches board size
  overlay.setAttribute('width', BOARD_PX);
  overlay.setAttribute('height', BOARD_PX);
  overlay.innerHTML = '';

  // draw ladders first (so snakes appear above if overlapping)
  for(const [sStr,eStr] of Object.entries(ladders)){
    const s = parseInt(sStr), e = parseInt(eStr);
    const [x1,y1] = cellCenter(s), [x2,y2] = cellCenter(e);
    const dx = x2 - x1, dy = y2 - y1;
    const len = Math.hypot(dx,dy) || 1;
    const ux = dx / len, uy = dy / len;
    // perpendicular unit
    const px = -uy, py = ux;
    const sep = 12; // separation between rails
    const x1a = x1 + px*sep, y1a = y1 + py*sep;
    const x2a = x2 + px*sep, y2a = y2 + py*sep;
    const x1b = x1 - px*sep, y1b = y1 - py*sep;
    const x2b = x2 - px*sep, y2b = y2 - py*sep;

    // rails
    const rail1 = document.createElementNS('http://www.w3.org/2000/svg','line');
    rail1.setAttribute('x1',x1a);rail1.setAttribute('y1',y1a);rail1.setAttribute('x2',x2a);rail1.setAttribute('y2',y2a);rail1.setAttribute('class','ladder-line');
    const rail2 = document.createElementNS('http://www.w3.org/2000/svg','line');
    rail2.setAttribute('x1',x1b);rail2.setAttribute('y1',y1b);rail2.setAttribute('x2',x2b);rail2.setAttribute('y2',y2b);rail2.setAttribute('class','ladder-line');
    overlay.appendChild(rail1);overlay.appendChild(rail2);

    // rungs
    const rungCount = Math.max(3, Math.floor(len / 60));
    for(let i=0;i<=rungCount;i++){
      const t = i / rungCount;
      const xr = x1 + dx * t; const yr = y1 + dy * t;
      const rxa = xr + px*sep*0.95, rya = yr + py*sep*0.95;
      const rxb = xr - px*sep*0.95, ryb = yr - py*sep*0.95;
      const rung = document.createElementNS('http://www.w3.org/2000/svg','line');
      rung.setAttribute('x1',rxa);rung.setAttribute('y1',rya);rung.setAttribute('x2',rxb);rung.setAttribute('y2',ryb);rung.setAttribute('class','ladder-rung');
      overlay.appendChild(rung);
    }

    // optional images at both ends (if provided)
    if(ladderImgData){
      const imgW = Math.min(48, Math.max(24, Math.floor(len/6)));
      const imgH = imgW;
      const imgTop = document.createElementNS('http://www.w3.org/2000/svg','image');
      imgTop.setAttribute('href', ladderImgData);
      imgTop.setAttribute('width', imgW); imgTop.setAttribute('height', imgH);
      imgTop.setAttribute('x', x2 - imgW/2); imgTop.setAttribute('y', y2 - imgH/2);
      const angle = Math.atan2(dy,dx) * 180/Math.PI;
      imgTop.setAttribute('transform', `rotate(${angle} ${x2} ${y2})`);
      overlay.appendChild(imgTop);

      const imgBot = document.createElementNS('http://www.w3.org/2000/svg','image');
      imgBot.setAttribute('href', ladderImgData);
      imgBot.setAttribute('width', imgW-10); imgBot.setAttribute('height', imgH-10);
      imgBot.setAttribute('x', x1 - (imgW-10)/2); imgBot.setAttribute('y', y1 - (imgH-10)/2);
      imgBot.setAttribute('transform', `rotate(${angle} ${x1} ${y1})`);
      overlay.appendChild(imgBot);
    } else {
      // small markers
      const topCircle = document.createElementNS('http://www.w3.org/2000/svg','circle');
      topCircle.setAttribute('cx',x2);topCircle.setAttribute('cy',y2);topCircle.setAttribute('r',10);topCircle.setAttribute('fill','#6d4c41');overlay.appendChild(topCircle);
      const bottomCircle = document.createElementNS('http://www.w3.org/2000/svg','circle');
      bottomCircle.setAttribute('cx',x1);bottomCircle.setAttribute('cy',y1);bottomCircle.setAttribute('r',8);bottomCircle.setAttribute('fill','#8d6e63');overlay.appendChild(bottomCircle);
    }
  }

  // snakes (draw above ladders)
  for(const [sStr,eStr] of Object.entries(snakes)){
    const s = parseInt(sStr), e = parseInt(eStr);
    const [x1,y1] = cellCenter(s), [x2,y2] = cellCenter(e);
    const dx = x2 - x1, dy = y2 - y1; const dist = Math.hypot(dx,dy);
    const offset = clamp(dist * 0.35, 40, 160);
    const cp1x = x1 + (dx * 0.3) - (dy/dist)*offset;
    const cp1y = y1 + (dy * 0.3) + (dx/dist)*offset;
    const cp2x = x1 + (dx * 0.7) - (dy/dist)*offset;
    const cp2y = y1 + (dy * 0.7) + (dx/dist)*offset;
    const path = document.createElementNS('http://www.w3.org/2000/svg','path');
    const d = `M ${x1} ${y1} C ${cp1x} ${cp1y} ${cp2x} ${cp2y} ${x2} ${y2}`;
    path.setAttribute('d', d); path.setAttribute('class','snake-path'); path.setAttribute('stroke-dasharray','8 6');
    overlay.appendChild(path);

    // snake head - use image if provided, else a circle + 'S'
    const angle = Math.atan2(dy,dx) * 180/Math.PI;
    if(snakeImgData){
      const imgW = Math.min(54, Math.max(28, Math.floor(dist/5)));
      const imgH = imgW;
      const img = document.createElementNS('http://www.w3.org/2000/svg','image');
      img.setAttribute('href', snakeImgData);
      img.setAttribute('width', imgW); img.setAttribute('height', imgH);
      img.setAttribute('x', x1 - imgW/2); img.setAttribute('y', y1 - imgH/2);
      img.setAttribute('transform', `rotate(${angle} ${x1} ${y1})`);
      overlay.appendChild(img);
    } else {
      const head = document.createElementNS('http://www.w3.org/2000/svg','circle');
      head.setAttribute('cx',x1);head.setAttribute('cy',y1);head.setAttribute('r',12);head.setAttribute('class','snake-head');overlay.appendChild(head);
      const label = document.createElementNS('http://www.w3.org/2000/svg','text');
      label.setAttribute('x',x1);label.setAttribute('y',y1+4);label.setAttribute('class','marker-label');label.textContent='S';overlay.appendChild(label);
    }
  }
}

// Build board DOM with correct zig-zag numbering (top-left = 100)
function createBoard(){
  boardEl.innerHTML = '';
  for(let rowFromTop = 0; rowFromTop < 10; rowFromTop++){
    const rowFromBottom = 9 - rowFromTop; // 9..0
    for(let col = 0; col < 10; col++){
      const withinRow = (rowFromBottom % 2 === 0) ? col : (9 - col);
      const n = rowFromBottom * 10 + withinRow + 1;
      const cell = document.createElement('div'); cell.className='cell'; cell.dataset.cell = n;
      const numdiv = document.createElement('div'); numdiv.className='num'; numdiv.textContent = n; cell.appendChild(numdiv);
      boardEl.appendChild(cell);
    }
  }
  drawOverlay();
}

function renderPlayers(){
  document.querySelectorAll('.cell .tokens').forEach(e=>e.remove());
  players.forEach((p, idx)=>{
    const pos = clamp(p.pos,1,100);
    const cell = boardEl.querySelector(`.cell[data-cell='${pos}']`) || boardEl.querySelector(`.cell[data-cell='1']`);
    let tokens = cell.querySelector('.tokens'); if(!tokens){ tokens = document.createElement('div'); tokens.className='tokens'; cell.appendChild(tokens); }
    const t = document.createElement('div'); t.className='token'; t.style.background = p.color; t.textContent = p.name.charAt(0).toUpperCase(); tokens.appendChild(t);
  });
}

function addPlayerField(name='Player'){
  const wrapper = document.createElement('div'); wrapper.className='player-row'; wrapper.style.display='flex'; wrapper.style.gap='8px'; wrapper.style.alignItems='center';
  const input = document.createElement('input'); input.type='text'; input.value = name; input.style.flex='1'; input.style.padding='8px';
  const colorBtn = document.createElement('input'); colorBtn.type='color'; colorBtn.value = COLORS[document.querySelectorAll('.player-row').length % COLORS.length];
  const remove = document.createElement('button'); remove.textContent='Remove'; remove.className='secondary'; remove.onclick = ()=>wrapper.remove();
  wrapper.appendChild(input); wrapper.appendChild(colorBtn); wrapper.appendChild(remove);
  playerInputs.appendChild(wrapper);
}

function startGame(){
  const rows = document.querySelectorAll('.player-row'); players = [];
  rows.forEach((r,i)=>{
    const name = r.querySelector('input[type=text]').value || `P${i+1}`;
    const color = r.querySelector('input[type=color]').value || COLORS[i%COLORS.length];
    players.push({name, pos:1, color});
  });
  if(players.length < 2){ alert('Add at least 2 players'); return; }
  started = true; currentPlayer = 0; rollBtn.disabled = false; startBtn.disabled = true; addPlayerBtn.disabled = true; logEl.innerHTML = '';
  log(`Game started with ${players.length} players`);
  renderPlayers(); updateTurnUI();
}

function resetGame(){
  started=false; players=[]; playerInputs.innerHTML=''; for(let i=0;i<2;i++) addPlayerField('Player '+(i+1)); createBoard(); renderPlayers(); startBtn.disabled=false; addPlayerBtn.disabled=false; rollBtn.disabled=true; diceEl.textContent='Dice: -'; currentTurnEl.textContent='Turn: -'; logEl.innerHTML='';
}

function updateTurnUI(){ if(players.length>0) currentTurnEl.textContent = `Turn: ${players[currentPlayer].name}`; }

function rollDice(){ if(!started) return; const n = Math.floor(Math.random()*6)+1; diceEl.textContent = `Dice: ${n}`; log(`${players[currentPlayer].name} rolled a ${n}`); movePlayer(currentPlayer, n); }

function movePlayer(idx, n){ const p = players[idx]; let target = p.pos + n; if(target > 100){ log(`${p.name} needs exact roll to reach 100`); nextTurn(); return; } p.pos = target; log(`${p.name} moves to ${p.pos}`); renderPlayers(); checkSpecialSquare(idx); }

function checkSpecialSquare(idx){ const p = players[idx]; const pos = p.pos; if(pos === 100){ log(`${p.name} wins! ðŸŽ‰`); rollBtn.disabled = true; return; } if(ladders[pos]){ if(ladderNeedsQuestion.checked){ askQuestionFor('ladder', idx, pos, ladders[pos]); } else { log(`${p.name} climbs ladder ${pos} â†’ ${ladders[pos]}`); p.pos = ladders[pos]; renderPlayers(); nextTurn(); } return; } if(snakes[pos]){ if(snakeNeedsQuestion.checked){ askQuestionFor('snake', idx, pos, snakes[pos]); } else { log(`${p.name} bitten by snake ${pos} â†’ ${snakes[pos]}`); p.pos = snakes[pos]; renderPlayers(); nextTurn(); } return; } nextTurn(); }

function askQuestionFor(type, idx, from, to){ pendingSpecial = {type, idx, from, to}; const q = questionBank[Math.floor(Math.random()*questionBank.length)]; openModal(q); }

function openModal(q){ qText.textContent = q.q; qChoices.innerHTML = ''; q.choices.forEach((c,i)=>{ const label = document.createElement('label'); label.style.cursor='pointer'; label.style.display='flex'; label.style.alignItems='center'; label.style.gap='8px'; const r = document.createElement('input'); r.type='radio'; r.name='choice'; r.value = i; if(i===0) r.checked = true; label.appendChild(r); const span = document.createElement('span'); span.textContent = c; label.appendChild(span); qChoices.appendChild(label); }); modal.style.display = 'flex'; submitAnswer.onclick = ()=>{ const sel = document.querySelector('input[name=choice]:checked'); const chosen = sel ? parseInt(sel.value) : -1; modal.style.display='none'; handleAnswer(q, chosen); }; cancelAnswer.onclick = ()=>{ modal.style.display='none'; handleAnswer(q, -1); }; }

function handleAnswer(q, chosen){ const correct = chosen === q.answer; const p = players[pendingSpecial.idx]; if(pendingSpecial.type === 'ladder'){ if(correct){ log(`${p.name} answered correctly and climbs ladder ${pendingSpecial.from} â†’ ${pendingSpecial.to}`); p.pos = pendingSpecial.to; renderPlayers(); } else { log(`${p.name} answered incorrectly and stays at ${pendingSpecial.from}`); } } else if(pendingSpecial.type === 'snake'){ if(correct){ log(`${p.name} answered correctly and avoids snake at ${pendingSpecial.from}`); } else { log(`${p.name} answered incorrectly and is bitten ${pendingSpecial.from} â†’ ${pendingSpecial.to}`); p.pos = pendingSpecial.to; renderPlayers(); } } pendingSpecial = null; nextTurn(); }

function nextTurn(){ if(players.length === 0) return; if(players[currentPlayer].pos === 100){ rollBtn.disabled = true; return; } currentPlayer = (currentPlayer + 1) % players.length; updateTurnUI(); }

// QUESTION BANK helpers
function refreshQuestionTextarea(){ questionData.value = JSON.stringify(questionBank, null, 2); }
function saveQuestionFromTextarea(){ try{ const parsed = JSON.parse(questionData.value); if(!Array.isArray(parsed)) throw 'JSON must be an array'; questionBank = parsed; alert('Questions saved'); } catch(e){ alert('Invalid JSON: ' + e); } }

// FILE UPLOAD HANDLERS FOR CUSTOM ICONS
snakeImageInput.addEventListener('change', function(e){ const f = this.files[0]; if(!f) return; const reader = new FileReader(); reader.onload = ()=>{ snakeImgData = reader.result; drawOverlay(); }; reader.readAsDataURL(f); });
ladderImageInput.addEventListener('change', function(e){ const f = this.files[0]; if(!f) return; const reader = new FileReader(); reader.onload = ()=>{ ladderImgData = reader.result; drawOverlay(); }; reader.readAsDataURL(f); });
clearIcons.addEventListener('click', ()=>{ snakeImgData = null; ladderImgData = null; snakeImageInput.value = ''; ladderImageInput.value = ''; drawOverlay(); });

// EVENTS
addPlayerBtn.onclick = ()=> addPlayerField('Player '+(document.querySelectorAll('.player-row').length+1));
startBtn.onclick = startGame; resetBtn.onclick = resetGame; rollBtn.onclick = ()=>{ rollBtn.disabled = true; setTimeout(()=>{ rollDice(); rollBtn.disabled = false; }, 120); };
// Save questions to file
saveQuestions.onclick = () => {
  saveQuestionFromTextarea();
  const blob = new Blob([JSON.stringify(questionBank,null,2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "questions.json";
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
};

// Load questions from JSON file
loadSample.onclick = () => fileInput.click();
fileInput.addEventListener("change", (e) => {
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = () => {
    try {
      const parsed = JSON.parse(reader.result);
      if(!Array.isArray(parsed)) throw "Not an array";
      questionBank = parsed;
      refreshQuestionTextarea();
      alert("Questions loaded from file");
    } catch(err) {
      alert("Invalid JSON: " + err);
    }
  };
  reader.readAsText(file);
});

// Expose for debugging
window.snakes = snakes; window.ladders = ladders; window.questionBank = questionBank; window.drawOverlay = drawOverlay;

// INIT
resetGame(); refreshQuestionTextarea();

// redraw overlay on resize (if CSS variable changed)
window.addEventListener('resize', ()=>{ drawOverlay(); });

</script>
</body>
</html>
